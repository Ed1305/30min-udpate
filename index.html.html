<!DOCTYPE html>
<html>
<head>
    <title>Campaign & Teams Performance</title>
    <style>
  :root{
    --bg: #ffffff;
    --card: #ffffff;
    --text: #000000;
    --muted: #666666;
    --border: #d0d0d0;
    --highlight: #f5f5f5;
    --total-bg: #4a4a4a;
    --radius: 0px;
  }

  html,body{
    height:100%;
    margin:0;
    font-family:"Segoe UI", Inter, Roboto, "Helvetica Neue", Arial, system-ui;
    background:var(--bg);
    color:var(--text);
    font-size:15px;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }
  body{padding:20px; display:flex; flex-direction:column; align-items:center;}

  h2{
    margin:20px 0 10px 0;
    font-size:18px;
    font-weight:700;
    color:var(--text);
    text-align:left;
    padding-left:2.5%;
  }

table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
    background: white;
    font-size: 14px;
}

th {
    background: #f3f3f3;
    padding: 8px;
    border: 1px solid #ccc;
    font-weight: 600;
    text-align: center;
    white-space: nowrap;
}

td {
    padding: 8px;
    border: 1px solid #ccc;
    text-align: center;
    white-space: nowrap;
}

/* INPUT FIELD STYLE REDUCED TO NORMAL SIZE */
input[type="number"], input[type="text"] {
    width: 90%;  /* slightly smaller */
    padding: 4px;  /* reduced padding */
    font-size: 12px; /* smaller font */
    border-radius: 4px;
    border: 1px solid #aaa;
}

th.col-small, td.col-small {
    width: 95px;
}

th.col-medium, td.col-medium {
    width: 120px;
}

th.col-large, td.col-large {
    width: 160px;
}

body {
    font-family: Arial, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

input[type=number]{
    background:#ffffff;
    border:1px solid var(--border);
    padding:2px 3px;
    border-radius:0px;
    color:var(--text);
    font-size:12px;
    box-sizing:border-box;
    text-align:right;
    width:100%;
}

input.targetField[readonly],
input[readonly].targetField {
    background: var(--highlight);
    border: 1px solid var(--border);
    color: var(--text);
    font-weight:700;
    text-align:right;
    padding:2px 3px;
    border-radius:0px;
    min-width:30px;
    max-width:90px;
    width:auto;
    display:inline-block;
}

td > input.targetField[readonly] { margin-left: auto; margin-right: 0; }

.calc-cell{
    background:transparent;
    color:var(--text);
    padding:4px 4px;
    font-weight:400;
    border-radius:0px;
    font-size:12px;
}

tfoot tr{ background: transparent; }
tfoot td{
    padding:6px 4px;
    font-size:12px;
    font-weight:700;
    color:#ffffff;
    background:var(--total-bg);
    text-align:right;
    border-right:1px solid #5a5a5a;
}
tfoot td:first-child{ text-align:left; padding-left:6px; }
tfoot td:last-child{ border-right:none; }

.pctWrap{ display:inline-block; background:#f1f3f4; height:8px; border-radius:999px; overflow:hidden; width:90px; vertical-align:middle; }
.pctBar{ height:100%; background:#bdbdbd; width:0%; transition:width 200ms ease; }
.pctText{ margin-left:8px; color:var(--muted); font-size:12px; font-weight:700; }

#exportWrap{ position:fixed; right:18px; bottom:18px; z-index:9999; }
#exportPngBtn{ font-size:11px; font-weight:400; padding:8px 14px; border-radius:4px; border:0; background:#4a4a4a; color:#fff; cursor:pointer; box-shadow:0 2px 6px rgba(0,0,0,0.15); }

@media(max-width:1100px){
  table{ width:100%; display:block; overflow:auto; }
}

@media(max-width:700px){
  html,body{ font-size:14px; }
  thead th, tbody td { padding:6px 6px; font-size:12px; white-space:normal; }
  input[type=number]{ font-size:12px; padding:3px; }
  input.targetField[readonly]{ min-width:40px; max-width:85px; }
  #exportPngBtn{ padding:8px 10px; font-size:11px; }
}
    </style>
</head>
<body>

<h2>Campaign Performance</h2>
<table id="campaignTable">
    <thead>
        <tr>
            <th>Campaign Code</th>
            <th onclick="sortTable(1)">Campaign Name ↑↓</th>
            <th>Sale</th>
            <th>B-Sale</th>
            <th>Hours</th>
            <th>Headcount</th>
            <th>Target</th>
            <th>Avg/hour</th>
            <th>Avg/Agent</th>
            <th>% to Target</th>
            <th>Wait Time</th>
        </tr>
    </thead>
    <tbody id="campaignBody"></tbody>
    <tfoot>
        <tr class="calc-cell">
            <td colspan="2">Total</td>
            <td id="totalSale">0</td>
            <td id="totalBSale">0</td>
            <td id="totalHours">0</td>
            <td id="totalHeadcount">0</td>
            <td id="totalTarget">0</td>
            <td id="totalAvgHour">0</td>
            <td id="totalAvgAgent">0</td>
            <td id="totalPctTarget">0%</td>
            <td id="totalWait">0</td>
        </tr>
    </tfoot>
</table>

<h2>Teams Performance</h2>
<table id="teamsTable">
    <thead>
        <tr>
            <th>Team Name</th>
            <th>Sale</th>
            <th>B-Sale</th>
            <th>Hours</th>
            <th>Headcount</th>
            <th>Target</th>
            <th>Avg/hour</th>
            <th>Avg/Agent</th>
            <th>% to Target</th>
        </tr>
    </thead>
    <tbody id="teamsBody"></tbody>
    <tfoot>
        <tr class="calc-cell">
            <td>Total</td>
            <td id="teamTotalSale">0</td>
            <td id="teamTotalBSale">0</td>
            <td id="teamTotalHours">0</td>
            <td id="teamTotalHeadcount">0</td>
            <td id="teamTotalTarget">0</td>
            <td id="teamTotalAvgHour">0</td>
            <td id="teamTotalAvgAgent">0</td>
            <td id="teamTotalPctTarget">0%</td>
        </tr>
    </tfoot>
</table>

<div id="exportWrap" style="position:fixed;right:10px;bottom:10px;z-index:9999">
  <button id="exportPngBtn" style="font-size:11px;padding:8px 10px;border-radius:6px;border:0;background:#2f2f2f;color:#fff;cursor:pointer">
    Send Update
  </button>
</div>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script>
  document.getElementById('exportPngBtn').addEventListener('click', async () => {
    const btn = document.getElementById('exportPngBtn');
    btn.disabled = true;
    const originalText = btn.textContent;
    btn.textContent = '30min Update...';

    try {
      const target = document.documentElement;
      const canvas = await html2canvas(target, { scale: 1, useCORS: true, backgroundColor: '#ffffff' });
      const downscale = 0.9;
      const w = Math.max(1, Math.round(canvas.width * downscale));
      const h = Math.max(1, Math.round(canvas.height * downscale));
      const tmp = document.createElement('canvas');
      tmp.width = w; tmp.height = h;
      const ctx = tmp.getContext('2d');
      ctx.drawImage(canvas, 0, 0, w, h);
      const dataUrl = tmp.toDataURL('image/jpeg', 0.99);
      const link = document.createElement('a');
      link.href = dataUrl;
      link.download = '30min_update_small.jpg';
      document.body.appendChild(link);
      link.click();
      link.remove();
    } catch (err) {
      console.error(err);
      alert('Export failed. See console for details.');
    } finally {
      btn.disabled = false;
      btn.textContent = originalText;
    }
  });
</script>

<script>
const campaigns = [
    ["ABSA", "ABSA", 20],
    ["CLKCTKP3", "CARTRACK", 70],
    ["CT_TELEA", "AUTO&GEN", 60],
    ["CT_TELEB", "BUDGET", 50],
    ["CT_TELED", "DIAL DIRECT", 10],
    ["CT_TELEF", "FFW", 60],
    ["DISBIZLI", "DISCOVERY", 10],
    ["ICNIWYZE", "LIFE", 20],
    ["INCLMWDS", "MIWAY", 100],
    ["INVCTAGP", "INVCTAGP", 20],
    ["KP2_CTN", "KING PRICE", 35],
    ["MIWAYNEW", "MIWAYNEW", 35],
    ["OMDINVNT", "OMDEALER", 125]
];

const teams = [
    ["Team Chad", 220],
    ["Team Moses", 200],
    ["Team  Prosper", 172],
    ["Team Sonwabile", 72],
    ["Trainees ", 70]
];

function loadTeamRows() {
    const tbody = document.getElementById("teamsBody");
    tbody.innerHTML = "";
    teams.forEach((team, idx) => {
        const row = document.createElement("tr");
        row.dataset.teamIndex = idx;
        row.innerHTML = `
            <td>${team[0]}</td>
            <td><input type="number" class="small"></td>
            <td><input type="number" class="small"></td>
            <td><input type="number" class="small"></td>
            <td><input type="number" class="small headcount" placeholder=""></td>
            <td><input type="number" class="small targetField" value="${team[1]}" readonly></td>
            <td class="calc-cell avgHour">0</td>
            <td class="calc-cell avgAgent">0</td>
            <td class="calc-cell pctTarget">0%</td>
        `;
        tbody.appendChild(row);

        row.querySelector(".headcount").addEventListener("input", () => {
            updateCampaignHeadcount();
            recalcRow(row);
            updateTeamTotals();
        });

        Array.from(row.querySelectorAll("input")).forEach(input => {
            input.addEventListener("input", () => {
                recalcRow(row);
                updateTeamTotals();
            });
        });
    });
}

function loadCampaignRows() {
    const tbody = document.getElementById("campaignBody");
    tbody.innerHTML = "";
    campaigns.forEach(camp => {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${camp[0]}</td>
            <td>${camp[1]}</td>
            <td><input type="number" class="small"></td>
            <td><input type="number" class="small"></td>
            <td><input type="number" class="small"></td>
            <td><input type="number" class="small headcount" readonly></td>
            <td><input type="number" class="small targetField" value="${camp[2]}" readonly></td>
            <td class="calc-cell avgHour">0</td>
            <td class="calc-cell avgAgent">0</td>
            <td class="calc-cell pctTarget">0%</td>
            <td><input type="number" class="small waitTime"></td>
        `;
        tbody.appendChild(row);

        Array.from(row.querySelectorAll("input")).forEach(input => {
            input.addEventListener("input", () => {
                recalcRow(row);
                updateCampaignTotals();
            });
        });
    });

    updateCampaignHeadcount();
}

// ... rest of your JS remains exactly the same ...
loadTeamRows();
loadCampaignRows();
updateTeamTotals();
updateCampaignTotals();
</script>

</body>
</html>
